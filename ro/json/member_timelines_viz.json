{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "autosize": "pad",
  "padding": 5,
  "width": 400,
  "title": {
    "text": {
      "signal": "Simple"
    },
    "frame": "group"
  },
  "style": "cell",
  "data": [{
      "name": "data",
      "values": [],
      "transform": [{
        "type": "filter",
        "expr": "datum.Simple==Simple"
      }]
    },
    {
      "name": "data_0",
      "source": "data",
      "transform": [{
          "type": "formula",
          "expr": "toDate(datum[\"start\"])",
          "as": "start"
        },
        {
          "type": "formula",
          "expr": "toDate(datum[\"end\"])",
          "as": "end"
        }
      ]
    },
    {
      "name": "data_1",
      "source": "data_0",
      "transform": [{
        "type": "filter",
        "expr": "datum[\"start\"] !== null && !isNaN(datum[\"start\"])"
      }]
    }
  ],
  "signals": [
    {
      "name": "Simple",
      "value": "",
      "bind": {
        "input": "select",
        "options": [],
        "name": "Személy"
      }
    },
    {
      "name": "Name",
      "value": "datum.Name"
    },
    {
      "name": "y_step",
      "value": 20
    },
    {
      "name": "height",
      "update": "bandspace(domain('y').length, 0.1, 0.05) * y_step"
    }
  ],
  "marks": [{
    "name": "marks",
    "type": "rect",
    "style": ["bar"],
    "from": {
      "data": "data_1"
    },
    "encode": {
      "update": {
        "fill": {
          "scale": "color",
          "field": "Típus"
        },
        "tooltip": {
          "signal": "{\"Típus\": ''+datum[\"Típus\"], \"start\": timeFormat(datum[\"start\"], '%b %d, %Y'), \"end\": timeFormat(datum[\"end\"], '%b %d, %Y'), \"Csoportok\": ''+datum[\"Csoportok\"]}"
        },
        "x": {
          "scale": "x",
          "field": "start"
        },
        "x2": {
          "scale": "x",
          "field": "end"
        },
        "y": {
          "scale": "y",
          "field": "Csoportok"
        },
        "height": {
          "scale": "y",
          "band": true
        }
      }
    }
  }],
  "scales": [{
      "name": "x",
      "type": "time",
      "domain": {
        "data": "data_1",
        "fields": ["start", "end"]
      },
      "range": [0, {
        "signal": "width"
      }]
    },
    {
      "name": "y",
      "type": "band",
      "domain": {
        "data": "data_0",
        "field": "Csoportok",
        "sort": {
          "op": "mean",
          "field": "order",
          "order": "descending"
        }
      },
      "range": {
        "step": {
          "signal": "y_step"
        }
      },
      "paddingInner": 0.1,
      "paddingOuter": 0.05
    },
    {
      "name": "color",
      "type": "ordinal",
      "domain": {
        "data": "data_0",
        "field": "Típus",
        "sort": {
          "op": "mean",
          "field": "order",
          "order": "descending"
        }
      },
      "range": "category"
    }
  ],
  "axes": [{
      "scale": "x",
      "orient": "bottom",
      "grid": false,
      "labelFlush": true,
      "labelOverlap": true,
      "tickCount": {
        "signal": "ceil(width/40)"
      },
      "zindex": 1
    },
    {
      "scale": "x",
      "orient": "bottom",
      "gridScale": "y",
      "grid": true,
      "tickCount": {
        "signal": "ceil(width/40)"
      },
      "domain": false,
      "labels": false,
      "maxExtent": 0,
      "minExtent": 0,
      "ticks": false,
      "zindex": 0
    },
    {
      "scale": "y",
      "orient": "left",
      "grid": false,
      "zindex": 1
    }
  ],
  "legends": [{
    "fill": "color",
    "gradientLength": {
      "signal": "clamp(height, 64, 200)"
    },
    "symbolType": "circle",
    "title": "Típus",
    "encode": {
      "symbols": {
        "update": {
          "shape": {
            "value": "square"
          }
        }
      }
    }
  }]
}